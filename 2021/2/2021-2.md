## 2021-2-3

+ https://github.com/YoKeyword/Fragmentation 已废弃，替代库：https://github.com/weikaiyun/SFragmentation
+ iPhone 安装非APP store 应用：https://www.i4.cn/，，，然后把IPA导入到应用。
+ iphone翻墙
  - 安装shadowrocket
  - https://book.v2rayx.org/ios.html
  - 输入密码等：https://store.holytech.tech/clientarea.php?action=productdetails&id=75496



## 2021-2-2

+ AGP 3.6.0 对应gradle 5.6.4

  - 会使用一个新的打包工具 zipflinger 来构建 APK,如果不想使用，在gradle.properties里添加

    ```
    android.useNewApkCreator=false
    ```

  - 简化R类生成过程：每个模块独立生成一个R，并与其他模块共享。

    ```
    如果库 A 将库 B 添加为“api”依赖项，则库 A 和其他依赖于库 A 的库都可以访问库 B 的 R 类。不过，如果库 A 使用 implementation 依赖项配置，则其他库可能无权访问库 B 的 R 类。
    ```

+ 错误处理:androidx/appcompat/R$drawable

  ```
  java.lang.NoClassDefFoundError: Failed resolution of: Landroidx/appcompat/R$drawable
  升级部分依赖，支持gradle3.6.0 ，升级realm
  ```

+ Realm  api:https://realm.io/docs/java/latest/

+ Realm changlog:https://github.com/realm/realm-java/blob/master/CHANGELOG.md

+ 万用表

  - 黑线接com，红线接测试的对应功能
  - 测量电压不分正负极，如果反了，屏幕上是负值

+ 错误处理: admob  Service not registered，，，，，不需要处理

+ A库api了B库，B库中依赖了某个三方库，如果需要再A中使用B中三方库。则，需要在B中api三分裤，如果用implementation，则报找不到类

+ google admob 开屏广告集成：https://developers.google.com/admob/android/app-open-ads?hl=zh-CN#track

  ```
  + 项目使用AndroidX
  + allprojects中引入google()
  + 添加依赖：
  implementation 'com.google.android.gms:play-services-ads:19.6.0'
  def lifecycle_version = "2.0.0"
      implementation "androidx.lifecycle:lifecycle-extensions:$lifecycle_version"
      implementation "androidx.lifecycle:lifecycle-runtime:$lifecycle_version"
      annotationProcessor "androidx.lifecycle:lifecycle-compiler:$lifecycle_version"
      
  + 添加meta-data
   <meta-data
              android:name="com.google.android.gms.ads.APPLICATION_ID"
              android:value="ca-app-pub-xxxxxxxxxxxxxxxx~yyyyyyyyyy"/>// 真实ID
              
   + 复制AppOpenManager
   private static final String LOG_TAG = "AppOpenManager";
      private static final String AD_UNIT_ID = "ca-app-pub-3940256099942544/3419835294";
      private AppOpenAd appOpenAd = null;
  
      private AppOpenAd.AppOpenAdLoadCallback loadCallback;
  
      private final App myApplication;
      private long loadTime = 0;
  
      /**
       * Constructor
       */
      public AppOpenManager(App myApplication) {
          this.myApplication = myApplication;
          this.myApplication.registerActivityLifecycleCallbacks(this);
          ProcessLifecycleOwner.get().getLifecycle().addObserver(this);
      }
  
      /**
       * LifecycleObserver methods
       */
      @OnLifecycleEvent(ON_START)
      public void onStart() {
          showAdIfAvailable();
          Log.d(LOG_TAG, "onStart");
      }
  
      /**
       * Request an ad
       */
      public void fetchAd() {
  //        if (isAdAvailable()) {
  //            return;
  //        }
  
          loadCallback =
                  new AppOpenAd.AppOpenAdLoadCallback() {
                      /**
                       * Called when an app open ad has loaded.
                       *
                       * @param ad the loaded app open ad.
                       */
                      @Override
                      public void onAppOpenAdLoaded(AppOpenAd ad) {
                          AppOpenManager.this.appOpenAd = ad;
                          AppOpenManager.this.loadTime = (new Date()).getTime();
                      }
  
                      /**
                       * Called when an app open ad has failed to load.
                       *
                       * @param loadAdError the error.
                       */
                      @Override
                      public void onAppOpenAdFailedToLoad(LoadAdError loadAdError) {
                          // Handle the error.
                      }
  
                  };
          AdRequest request = getAdRequest();
          AppOpenAd.load(
                  myApplication, AD_UNIT_ID, request,
                  AppOpenAd.APP_OPEN_AD_ORIENTATION_PORTRAIT, loadCallback);
      }
  
      /**
       * Creates and returns ad request.
       */
      private AdRequest getAdRequest() {
          return new AdRequest.Builder().build();
      }
  
      /**
       * Utility method that checks if ad exists and can be shown.
       */
      public boolean isAdAvailable() {
          return appOpenAd != null && wasLoadTimeLessThanNHoursAgo(4);
      }
  
      private boolean wasLoadTimeLessThanNHoursAgo(long numHours) {
          long dateDifference = (new Date()).getTime() - this.loadTime;
          long numMilliSecondsPerHour = 3600000;
          return (dateDifference < (numMilliSecondsPerHour * numHours));
      }
  
      /**
       * ActivityLifecycleCallback methods
       */
      private Activity currentActivity;
  
      @Override
      public void onActivityCreated(Activity activity, Bundle savedInstanceState) {
      }
  
      @Override
      public void onActivityStarted(Activity activity) {
          currentActivity = activity;
      }
  
      @Override
      public void onActivityResumed(Activity activity) {
          currentActivity = activity;
      }
  
      @Override
      public void onActivityStopped(Activity activity) {
      }
  
      @Override
      public void onActivityPaused(Activity activity) {
      }
  
      @Override
      public void onActivitySaveInstanceState(Activity activity, Bundle bundle) {
      }
  
      @Override
      public void onActivityDestroyed(Activity activity) {
          currentActivity = null;
      }
  
  
      /**
       * Shows the ad if one isn't already showing.
       */
      private static boolean isShowingAd = false;
  
      public void showAdIfAvailable() {
          // Only show ad if there is not already an app open ad currently showing
          // and an ad is available.
          if (!isShowingAd && isAdAvailable()) {
              Log.d(LOG_TAG, "Will show ad.");
  
              FullScreenContentCallback fullScreenContentCallback =
                      new FullScreenContentCallback() {
                          @Override
                          public void onAdDismissedFullScreenContent() {
                              // Set the reference to null so isAdAvailable() returns false.
                              AppOpenManager.this.appOpenAd = null;
                              isShowingAd = false;
                              fetchAd();
                          }
  
                          @Override
                          public void onAdFailedToShowFullScreenContent(AdError adError) {
                          }
  
                          @Override
                          public void onAdShowedFullScreenContent() {
                              isShowingAd = true;
                          }
                      };
  
              appOpenAd.show(currentActivity, fullScreenContentCallback);
  
          } else {
              Log.d(LOG_TAG, "Can not show ad.");
              fetchAd();
          }
      }
   
   + 初始化
    MobileAds.initialize(
                  this,
                  new OnInitializationCompleteListener() {
                      @Override
                      public void onInitializationComplete(InitializationStatus initializationStatus) {
                          Log.e("MobileAds","MobileAds.initialize");
                      }
                  });
          appOpenManager = new AppOpenManager(this);
  ```

  



## 2021-2-1

+ 多账号ssh git提交

  ```
  对应项目下配置
  git config user.name ""
  git config user.email ""
  配置完之后
  [user]
  	name = XWindMan
  	email = xwindman@foxmail.com
  ```

+ 多账号配置

  ```
  .ssh/config
  # 个人账号xwindman@foxmail.com
  Host MyGithub
  HostName github.com
  User XWindMan
  IdentityFile ~/.ssh/id_rsa_xwindman
  ```

